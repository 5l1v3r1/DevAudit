# .NET Desktop
# https://docs.microsoft.com/azure/devops/pipelines/apps/windows/dot-net

name: $(Date:yyyyMMdd).$(Rev:.r) 

variables:
  releaseVersion: '3.2.0.0'

jobs:
- job: Linux
  pool:
    vmImage: 'ubuntu-16.04'
  steps:
  - script: $(Build.SourcesDirectory)/build.sh /p:VersionAssembly=$(releaseVersion)
  - task: ArchiveFiles@2
    inputs:
     rootFolderOrFile: '$(Build.SourcesDirectory)/DevAudit.CommandLine/bin/Debug/'
     includeRootFolder: false
     archiveType: tar
     tarCompression: gz
     archiveFile: 'DevAudit_$(releaseVersion).tar.gz'

  - task: CopyFiles@2
    inputs:
      SourceFolder: '$(Build.SourcesDirectory)'
      Contents: |
       'DevAudit_$(releaseVersion).tar.gz'
      TargetFolder: '$(Build.ArtifactStagingDirectory)'

  - task: PublishBuildArtifacts@1
    inputs:
      pathtoPublish: '$(Build.ArtifactStagingDirectory)'
      artifactName: 'DevAudit-$(releaseVersion)' 
